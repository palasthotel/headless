!function(){"use strict";var e=window.wp.plugins,t=window.wp.element,n=window.wp.editPost,o=window.wp.components,r=window.wp.data;(0,e.registerPlugin)("headless-plugin",{icon:()=>null,render:function(){const{state:e,reload:s}=(()=>{const[e,n]=(0,t.useState)("idle"),o=(0,r.useSelect)((e=>e("core/editor").getCurrentPost()));return{state:e,reload:()=>{n("loading"),fetch((e=>window.Headless.ajax+"?action="+window.Headless.actions.reload+"&post="+e)(o.id)).then((e=>e.json())).then((e=>{e.success?n("success"):(console.error(e),n("error"))})).catch((()=>{n("error")})).finally((()=>{setTimeout((()=>{n("idle")}),4e3)}))}}})();return(0,t.createElement)(n.PluginDocumentSettingPanel,{title:"Headless"},(0,t.createElement)(o.Button,{variant:"secondary",disabled:"idle"!=e,onClick:s},"Reload cache"),"idle"==e&&(0,t.createElement)("p",{className:"description"},"Reload contents in headless frontend."),"loading"==e&&(0,t.createElement)("p",null,"Loading..."),"success"==e&&(0,t.createElement)("p",null,"ðŸŽ‰ Success"),"error"==e&&(0,t.createElement)("p",null,"ðŸš¨ Something went wrong"))}}),document.addEventListener("DOMContentLoaded",(function(){setInterval((function(){const t=(()=>{const e=(0,r.select)("core/editor").getCurrentPostId();return window.Headless.preview_url.replace(window.Headless.post_id_placeholder,e)})(),n=e.querySelector(".edit-post-post-preview-dropdown .components-menu-group:has(.edit-post-header-preview__grouping-external)");if(!n)return;const o="headless-preview-link";if(n.querySelector("#"+o))return;const s=n.querySelector(".edit-post-header-preview__grouping-external"),l=s.getAttribute("target"),i=document.createElement("a");i.text=s.textContent,i.target=l,i.id=o,i.className="components-button",i.href=t,n.querySelector('[role="group"]').append(i)}),300);const e=document.querySelector("#editor")}))}();